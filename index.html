<html>
    <head>
        <title>Studio Ghibli Directors</title>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src="https://d3js.org/d3-array.v2.min.js"></script>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

        <style>
        html, body{
            height: 315%;
            padding: 10px;
            font-family: Georgia, 'Times New Roman', Times, serif;
            color: beige; 
            text-shadow:2px 2px 4px #0000008f;
        }
        .bg{
            background-image: url("ghibli-background.png");
            height: 100%;
            background-repeat: no-repeat;
            background-size: cover;
            background-color: rgba(255, 255, 255, 0.3);
            background-blend-mode: overlay;
        }
        /* https://www.geeksforgeeks.org/css-floating-animation/ */

        .floating {  
            animation-name: floating;
            animation-duration: 2s;
            animation-iteration-count: infinite;
            animation-timing-function: ease-in-out;
            margin-left: 30px;
            margin-top: 5px;
        }
        @keyframes floating { 
            0% { transform: translate(0,  0px); }
            50%  { transform: translate(0, 15px); }
            100%   { transform: translate(0, -0px); }    
        }
        a{
            color: rgb(230, 163, 19);
            text-shadow:2px 2px 4px #0000008f;

        }
        </style>
    </head>

    <body class = "bg">
        <div style = "display: flex; align-items:center; flex-direction: column;">
            <h1> <i>My Neighbor Takahata:</i> A Studio Ghibli Director Analysis </h1>
            <!-- <img class="floating" src = "ponyo.png" width = 180 height = 180 style="margin-left: 1200; position: absolute" > </img> -->
            <p>by Carly Hu (ch862) and Myna Lim (ml2326)</p>
            <h3 style = "background-color: rgb(4, 88, 96);"> "I gave Isao Takahata 15 years of my youth. I want them back!" - Hayao Miyazaki</h3>
        </div>

       
        <div style = "display: flex; flex-direction: row;">
            <div style = "display: flex; flex-direction: column; width: 700px;">
                <div style = "display: flex; flex-direction: column">
                <div style = "width: 600px">
                <p style = "margin: 20px"> In the world of animation, few names are as revered as Hayao Miyazaki, 
                    the pioneering spirit behind <a href = "https://en.wikipedia.org/wiki/Studio_Ghibli">Studio Ghibli</a>. 
                    Somewhat less popular is that of Isao Takahata's: another Ghibli director who had a thriving partnership and eventual divergence from Miyazaki. 
                    In his 2018 biography, Toshio Suzuki (President of Studio Ghibli) provides a glimpse into the
                    complexities of this <a href = "http://takara-bako.com/index.php/2021/01/21/miyazaki-takahatas-work-relationship-and-how-it-ended/">relationship</a>.</p>
                    <p style = "margin: 20px">In this article, we will use <a href = "https://www.kaggle.com/datasets/shruthiiiee/studio-ghibli-dataset">data</a> to explore the differences
                    that characterized Miyazaki, Takahata, and other directors' contributions to Studio Ghibli, 
                    examining key details between their respective films. </p>
                </div>
                <img class="floating" src = "totoro.png" width = 8%  style="margin-left: 600; margin-top: 10; position: absolute" > </img>
                </div>  
                <svg class="timeline" id = "timeline" style="margin: 20px; height: 2000px; width: 700px; border: 2px solid white; ">timeline</svg>

            </div>
                <div style = "display: flex; flex-direction: column; position: fixed; margin-left: 750;">
                    <div class = "select" style="margin: 20px; height: 120px; width: 600px; border: 2px solid white;"> select</div>
                    <div class = "chart" style="margin: 20px; height: 350px; width: 600px; border: 2px solid white;"> visualization</div>
                </div>
            </div>
    </body>

    <script>
        const requestData = async function(){
            const ghibliData = await d3.csv("studio-ghibli.csv");
            // console.log(ghibliData)
            console.log(ghibliData);

            const svg = d3.select("#timeline")
            let margin = { top: 50, bottom: 40, right: 35, left: 200 }
            const width = svg.attr("width");
            const height = svg.attr("height");
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;
            let annotations = svg.append("g").attr("id","annotations");

            svg.append('rect')
                .attr('x', 55)
                .attr('y', 43)
                .attr('width', 240)
                .style("text-anchor", "middle")
                .attr('height', 20)
                .attr('fill', 'white')
                .attr("opacity", 0.6);
            svg.append('text')
                .text("Isao Takahata / Others")
                .attr('x', 175)
                .attr('y', 60)
                .style("font-weight", "bold")
                .style("text-anchor", "middle")
                .attr('font-size', '20px')
                .style('fill', "#3A5311")
                .style('text-shadow', 'none');
            svg.append('rect')
                .attr('x', 440)
                .attr('y', 43)
                .attr('width', 170)
                .style("text-anchor", "middle")
                .attr('height', 20)
                .attr('fill', 'white')
                .attr("opacity", 0.6);
            svg.append('text')
                .text("Hayao Miyazaki")
                .attr('x', 175+350)
                .attr('y', 60)
                .style("font-weight", "bold")
                .style("text-anchor", "middle")
                .attr('font-size', '20px')
                .style('fill', "#281E50")
                .style('text-shadow', 'none');
            
            svg.append('rect')
            .attr('x', 350)
            .attr('y', 100)
            .attr('width', 20)
            .attr('height', 1800)
            .attr('stroke', 'white')
            .attr('fill', 'white')
            .attr('opacity', 0.5);

            const yearExtent = d3.extent(ghibliData, d => d.Year);
            const yearScale = d3.scaleLinear()
                .domain(yearExtent)
                .range([100, 1900]);

            const directors = d3.map(ghibliData, d => d.Director)
            const directorScale = d3.scaleBand()
                .domain(directors)
                .range([chartWidth/2-chartWidth/4, chartWidth/2+chartWidth/4])
                .padding([0.2]);
            
            let leftAxis = d3.axisLeft(yearScale).tickFormat(d3.format(''));
            annotations.append("g")
                    .attr("class", "y axis")
                    .attr("transform",`translate(${margin.left+170},${0})`)
                    .style("stroke", 'black')
                    .call(leftAxis)
                    .selectAll("line")
                    .style("stroke", "black"); // Change tick line color



            // const movies = d3.map(ghibliData, d => d.Name)
            // const moviesScale = d3.scaleBand()
            //                 .domain(movies)
            //                 .range([0, 10])
            //                 .padding([0.2])

                        // var yScale = d3.scaleBand()
                        //             .domain(breakdowns)
                        //             .range([10, breakHeight])
                        //             .padding([0.2])
            
        }
        requestData();

    </script>
</html>